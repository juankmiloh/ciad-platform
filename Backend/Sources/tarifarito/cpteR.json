{
    "name": "empresas",
    "query": [
        "SELECT ",
        "    T9.*,",
        "    T10.*,",
        "    TC2.*,",
        "    (T10.C1 + T10.C2 + T10.C3 + T9.C4) AS C5,",
        "    (T10.C1 + T10.C2 + T10.C3 + T9.C4) / TC2.C6 AS C7 ",
        "FROM ",
        "(",
        "    SELECT ",
        "        ID_EMPRESA,",
        "        CAR_1672_ID_MERCADO,",
        "        CAR_CARG_ANO,",
        "        CAR_CARG_PERIODO,",
        "        CAR_1672_AREST AS C4 ",
        "    FROM ",
        "        ENERGIA_CREG_015.CAR_VAR_COSTO_UNT_PS_CU_119_UR ",
        "    WHERE ",
        "        CAR_CARG_ANO = :ANIO_ARG ",
        "        AND CAR_CARG_PERIODO = :PERIODO_ARG ",
        "        AND (ID_EMPRESA = :EMPRESA_ARG OR 0 = :EMPRESA_ARG) ",
        "        AND (CAR_1672_ID_MERCADO = :MERCADO_ARG OR 0 = :MERCADO_ARG) ",
        ") T9,",
        "(",
        "    SELECT ",
        "        CAR_T1671_RTCSA AS C1,",
        "        CAR_T1671_VDESV AS C2,",
        "        CAR_T1671_GUATAPE AS C3 ",
        "    FROM ENERGIA_CREG_015.CAR_T1671_INFORMACION_ASIC_LAC ",
        "    WHERE CAR_CARG_ANO = :ANIO_ARG ",
        "    and CAR_CARG_PERIODO = :PERIODO_ARG ",
        "    AND (CAR_T1671_ID_EMPRESA = :EMPRESA_ARG OR 0 = :EMPRESA_ARG) ",
        ") T10,",
        "(",
        "    SELECT ",
        "        NVL((FACTURAI.VT + REFACT.VT), 0) AS C6 ",
        "    FROM ",
        "    (",
        "        SELECT MERCADO, SUM(VT) AS VT FROM (",
        "        SELECT ",
        "            TO_NUMBER(SUBSTR(CAR_T1743_MERCADO_NIU, 1, INSTR(CAR_T1743_MERCADO_NIU, '-')-1)) AS MERCADO,",
        "            (CAR_T1743_CONS_USUARIO + CAR_T1743_CONS_CDC) AS VT ",
        "        FROM ENERGIA_CREG_015.CAR_T1743_TC2FACTURACION_USU ",
        "        WHERE ",
        "            IDENTIFICADOR_EMPRESA = :EMPRESA_ARG ",
        "            AND CAR_CARG_PERIODO = :PERIODO_ARG_MENOS1 ",
        "            AND CAR_CARG_ANO = :ANIO_ARG ",
        "            AND CAR_T1743_TIPO_FACT = 1 ",
        "        ) GROUP BY MERCADO",
        "    ) FACTURAI,",
        "    (",
        "        SELECT MERCADO, SUM(VT) AS VT FROM (",
        "        SELECT ",
        "            TO_NUMBER(SUBSTR(CAR_T1743_MERCADO_NIU, 1, INSTR(CAR_T1743_MERCADO_NIU, '-')-1)) AS MERCADO,",
        "            CASE WHEN car_t1743_val_rft_cu >=0 THEN (CAR_T1743_RFT_CU*1) + CAR_T1743_RFT_CDC ELSE (CAR_T1743_RFT_CU*-1) + CAR_T1743_RFT_CDC END AS VT ",
        "        FROM ENERGIA_CREG_015.CAR_T1743_TC2FACTURACION_USU ",
        "        WHERE ",
        "            IDENTIFICADOR_EMPRESA = :EMPRESA_ARG ",
        "            AND CAR_CARG_PERIODO = :PERIODO_ARG_MENOS1 ",
        "            AND CAR_CARG_ANO = :ANIO_ARG ",
        "            AND CAR_T1743_TIPO_FACT NOT IN 1 ",
        "        ) GROUP BY MERCADO",
        "    ) REFACT",
        ") TC2"
    ]
}